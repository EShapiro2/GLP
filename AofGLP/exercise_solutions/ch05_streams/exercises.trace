%% Exercise solutions traces - Chapter 5: Streams

%% ============================================================
%% Exercise 1: length/2 - Count list elements
%% Goal: length([a,b,c,d,e], N).
%% Result: N = 5
%% ============================================================

length([a, b, c, d, e], N) :- length_acc([a, b, c, d, e], 0, X1)
length_acc([a, b, c, d, e], 0, X1) :- :=/2(X2, +(0, 1)), length_acc([b, c, d, e], X2?, X3)
:=/2(X2, +(0, 1)) :- true
length_acc([b, c, d, e], 1, X3) :- :=/2(X4, +(1, 1)), length_acc([c, d, e], X4?, X5)
:=/2(X4, +(1, 1)) :- true
length_acc([c, d, e], 2, X5) :- :=/2(X6, +(2, 1)), length_acc([d, e], X6?, X7)
:=/2(X6, +(2, 1)) :- true
length_acc([d, e], 3, X7) :- :=/2(X8, +(3, 1)), length_acc([e], X8?, X9)
:=/2(X8, +(3, 1)) :- true
length_acc([e], 4, X9) :- :=/2(X10, +(4, 1)), length_acc([], X10?, X11)
:=/2(X10, +(4, 1)) :- true
length_acc([], 5, X11) :- true

N = 5
→ succeeds

%% ============================================================
%% Exercise 2: map_inc/2 - Increment each element
%% Goal: map_inc([1,2,3], R).
%% Result: R = [2, 3, 4]
%% ============================================================

map_inc([1, 2, 3], R) :- :=/2(X1, +(1, 1)), map_inc([2, 3], X2)
:=/2(X1, +(1, 1)) :- true
map_inc([2, 3], X2) :- :=/2(X3, +(2, 1)), map_inc([3], X4)
:=/2(X3, +(2, 1)) :- true
map_inc([3], X4) :- :=/2(X5, +(3, 1)), map_inc([], X6)
:=/2(X5, +(3, 1)) :- true
map_inc([], X6) :- true

R = [2, 3, 4]
→ succeeds

%% ============================================================
%% Exercise 3: filter_even/2 - Keep even numbers
%% Goal: filter_even([1,2,3,4,5,6], R).
%% Result: R = [2, 4, 6]
%% ============================================================

filter_even([1, 2, 3, 4, 5, 6], R) :- filter_even([2, 3, 4, 5, 6], X1)
filter_even([2, 3, 4, 5, 6], X1) :- filter_even([3, 4, 5, 6], X2)
filter_even([3, 4, 5, 6], X2) :- filter_even([4, 5, 6], X3)
filter_even([4, 5, 6], X3) :- filter_even([5, 6], X4)
filter_even([5, 6], X4) :- filter_even([6], X5)
filter_even([6], X5) :- filter_even([], X6)
filter_even([], X6) :- true

R = [2, 4, 6]
→ succeeds
