%% observer.glp - Stream observation without consumption
%% Source: GLP Papers (Program: Concurrent Observer)
%%
%% For non-ground data requiring observation without consumption.
%% Forwards communication bidirectionally while producing a
%% replicable audit stream.

observe(X?, Y, Z) :- observe(Y?, X, Z).
observe(X, X?, X?) :- ground(X) | true.
observe(Xs, [Y1?|Ys1?], [Y2?|Ys2?]) :-
    Xs? = [X|Xs1] |
    observe(X?, Y1, Y2),
    observe(Xs1?, Ys1, Ys2).
