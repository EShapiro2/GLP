%% fibonacci.glp - Fibonacci in GLP
%% Source: Standard GLP arithmetic

fib(0, 0).
fib(1, 1).
fib(N, F?) :-
    N? > 1 |
    N1 := N? - 1,
    N2 := N? - 2,
    fib(N1?, F1),
    fib(N2?, F2),
    F := F1? + F2?.

%% Metainterpreter support
reduce(fib(0, 0), true).
reduce(fib(1, 1), true).
reduce(fib(N, F?), (N1 := N? - 1, N2 := N? - 2, fib(N1?, F1), fib(N2?, F2), F := F1? + F2?)) :- N? > 1 | true.
reduce((X? := T), true) :- X := T? | true.
