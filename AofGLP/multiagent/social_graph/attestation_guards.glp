%% attestation_guards.glp - Security Guard Predicates
%% Source: GLP Papers (Section: Securing Multiagent GLP)
%%
%% Programs require ability to inspect attestations on received messages.
%% GLP provides guard predicates for security operations.
%%
%% attestation(X, Info) - succeeds if X carries an attestation
%%   Info binds to att(Agent, Module) containing attesting agent's
%%   public key and module identifier. For locally-produced terms,
%%   Agent binds to distinguished constant 'self'.
%%
%% module(M) - binds M to identifier of currently executing module.
%%   Agents use this to determine own module identity when evaluating
%%   compatibility with other agents' attested modules.

%% Example: Verify message attestation before processing
process_message(Msg, Result?) :-
    attestation(Msg, att(Agent, Module)),
    trusted_module(Module?) |
    handle_verified(Msg?, Agent?, Result).

process_message(Msg, rejected) :-
    attestation(Msg, att(_, Module)),
    \+ trusted_module(Module?) |
    true.

%% Example: Check own module for protocol decisions
negotiate_protocol(Other, Result?) :-
    module(MyModule),
    attestation(Other, att(_, OtherModule)),
    compatible(MyModule?, OtherModule?) |
    Result = accept.
